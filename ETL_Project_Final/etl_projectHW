{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## ETL-ASR 2018/11/17"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### The objective of this project was to Extract, Transform, and Load data into a newly created database. We found US Census Bureau data on Kaggle composed of various CSVs for all of the retail revenue channels. Our objective was to create a database for all of these data sources to coexist. First, we extracted the data sets from Kaggle, only to transform them by dropping what we deemed unimportant columns. This left us with two columns in each data set, Observation Date and Revenue. Our final step was to load all of these transformed data sets into MySQL for further manipulation."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Importing dependencies"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "from sqlalchemy import create_engine\n",
    "import pymysql\n",
    "pymysql.install_as_MySQLdb()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1- Extracting our Revenue Data CSVs from US Census into Data Frames"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>realtime_start</th>\n",
       "      <th>obs_date</th>\n",
       "      <th>revenue</th>\n",
       "      <th>realtime_end</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-01-01</td>\n",
       "      <td>10845</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-02-01</td>\n",
       "      <td>10904</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-03-01</td>\n",
       "      <td>10986</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-04-01</td>\n",
       "      <td>10738</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-05-01</td>\n",
       "      <td>10777</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  realtime_start    obs_date  revenue realtime_end\n",
       "0     2018-11-07  1992-01-01    10845   2018-11-07\n",
       "1     2018-11-07  1992-02-01    10904   2018-11-07\n",
       "2     2018-11-07  1992-03-01    10986   2018-11-07\n",
       "3     2018-11-07  1992-04-01    10738   2018-11-07\n",
       "4     2018-11-07  1992-05-01    10777   2018-11-07"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Building materials\n",
    "building_materials = 'Resources/etl1_building_material.csv'\n",
    "building_materials_df = pd.read_csv(building_materials)\n",
    "building_materials_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>realtime_start</th>\n",
       "      <th>obs_date</th>\n",
       "      <th>revenue</th>\n",
       "      <th>realtime_end</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-01-01</td>\n",
       "      <td>6938</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-02-01</td>\n",
       "      <td>7524</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-03-01</td>\n",
       "      <td>8475</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-04-01</td>\n",
       "      <td>9401</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-05-01</td>\n",
       "      <td>9558</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  realtime_start    obs_date  revenue realtime_end\n",
       "0     2018-11-07  1992-01-01     6938   2018-11-07\n",
       "1     2018-11-07  1992-02-01     7524   2018-11-07\n",
       "2     2018-11-07  1992-03-01     8475   2018-11-07\n",
       "3     2018-11-07  1992-04-01     9401   2018-11-07\n",
       "4     2018-11-07  1992-05-01     9558   2018-11-07"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Clothing stores\n",
    "clothing_store = 'Resources/etl2_clothing_stores.csv'\n",
    "clothing_store_df = pd.read_csv(clothing_store)\n",
    "clothing_store_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>realtime_start</th>\n",
       "      <th>obs_date</th>\n",
       "      <th>revenue</th>\n",
       "      <th>realtime_end</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-01-01</td>\n",
       "      <td>14134</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-02-01</td>\n",
       "      <td>14472</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-03-01</td>\n",
       "      <td>14543</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-04-01</td>\n",
       "      <td>14529</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-05-01</td>\n",
       "      <td>14634</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  realtime_start    obs_date  revenue realtime_end\n",
       "0     2018-11-07  1992-01-01    14134   2018-11-07\n",
       "1     2018-11-07  1992-02-01    14472   2018-11-07\n",
       "2     2018-11-07  1992-03-01    14543   2018-11-07\n",
       "3     2018-11-07  1992-04-01    14529   2018-11-07\n",
       "4     2018-11-07  1992-05-01    14634   2018-11-07"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Sales departments\n",
    "sales_department = 'Resources/etl3_retail_sales_department.csv'\n",
    "sales_department_df = pd.read_csv(sales_department)\n",
    "sales_department_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>realtime_start</th>\n",
       "      <th>obs_date</th>\n",
       "      <th>revenue</th>\n",
       "      <th>realtime_end</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-01-01</td>\n",
       "      <td>3874</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-02-01</td>\n",
       "      <td>3904</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-03-01</td>\n",
       "      <td>3916</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-04-01</td>\n",
       "      <td>3958</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-05-01</td>\n",
       "      <td>3981</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  realtime_start    obs_date  revenue realtime_end\n",
       "0     2018-11-07  1992-01-01     3874   2018-11-07\n",
       "1     2018-11-07  1992-02-01     3904   2018-11-07\n",
       "2     2018-11-07  1992-03-01     3916   2018-11-07\n",
       "3     2018-11-07  1992-04-01     3958   2018-11-07\n",
       "4     2018-11-07  1992-05-01     3981   2018-11-07"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Sales electronics\n",
    "sales_electronics = 'Resources/etl4_sales_electronics.csv'\n",
    "sales_electronics_df = pd.read_csv(sales_electronics)\n",
    "sales_electronics_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>realtime_start</th>\n",
       "      <th>obs_date</th>\n",
       "      <th>revenue</th>\n",
       "      <th>realtime_end</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-01-01</td>\n",
       "      <td>30437</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-02-01</td>\n",
       "      <td>30382</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-03-01</td>\n",
       "      <td>30526</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-04-01</td>\n",
       "      <td>30602</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-05-01</td>\n",
       "      <td>30718</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  realtime_start    obs_date  revenue realtime_end\n",
       "0     2018-11-07  1992-01-01    30437   2018-11-07\n",
       "1     2018-11-07  1992-02-01    30382   2018-11-07\n",
       "2     2018-11-07  1992-03-01    30526   2018-11-07\n",
       "3     2018-11-07  1992-04-01    30602   2018-11-07\n",
       "4     2018-11-07  1992-05-01    30718   2018-11-07"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# ßales food and baverage\n",
    "sales_food_bev = 'Resources/etl5_sales_food_beverage.csv'\n",
    "sales_food_bev_df = pd.read_csv(sales_food_bev)\n",
    "sales_food_bev_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>realtime_start</th>\n",
       "      <th>obs_date</th>\n",
       "      <th>revenue</th>\n",
       "      <th>realtime_end</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-01-01</td>\n",
       "      <td>15693</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-02-01</td>\n",
       "      <td>15835</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-03-01</td>\n",
       "      <td>16848</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-04-01</td>\n",
       "      <td>16494</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-05-01</td>\n",
       "      <td>17648</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  realtime_start    obs_date  revenue realtime_end\n",
       "0     2018-11-07  1992-01-01    15693   2018-11-07\n",
       "1     2018-11-07  1992-02-01    15835   2018-11-07\n",
       "2     2018-11-07  1992-03-01    16848   2018-11-07\n",
       "3     2018-11-07  1992-04-01    16494   2018-11-07\n",
       "4     2018-11-07  1992-05-01    17648   2018-11-07"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Sales food and service\n",
    "sales_food_ser = 'Resources/etl6_sales_food_services_drinking_places.csv'\n",
    "sales_food_ser_df = pd.read_csv(sales_food_ser)\n",
    "sales_food_ser_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>realtime_start</th>\n",
       "      <th>obs_date</th>\n",
       "      <th>revenue</th>\n",
       "      <th>realtime_end</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-01-01</td>\n",
       "      <td>3846</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-02-01</td>\n",
       "      <td>3908</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-03-01</td>\n",
       "      <td>4157</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-04-01</td>\n",
       "      <td>4141</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-05-01</td>\n",
       "      <td>4275</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  realtime_start    obs_date  revenue realtime_end\n",
       "0     2018-11-07  1992-01-01     3846   2018-11-07\n",
       "1     2018-11-07  1992-02-01     3908   2018-11-07\n",
       "2     2018-11-07  1992-03-01     4157   2018-11-07\n",
       "3     2018-11-07  1992-04-01     4141   2018-11-07\n",
       "4     2018-11-07  1992-05-01     4275   2018-11-07"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Home furniture\n",
    "furniture_home = 'Resources/etl7_furniture_home_furnishings_stores.csv'\n",
    "furniture_home_df = pd.read_csv(furniture_home)\n",
    "furniture_home_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>realtime_start</th>\n",
       "      <th>obs_date</th>\n",
       "      <th>revenue</th>\n",
       "      <th>realtime_end</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-01-01</td>\n",
       "      <td>10845</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-02-01</td>\n",
       "      <td>10904</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-03-01</td>\n",
       "      <td>10986</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-04-01</td>\n",
       "      <td>10738</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-05-01</td>\n",
       "      <td>10777</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  realtime_start    obs_date  revenue realtime_end\n",
       "0     2018-11-07  1992-01-01    10845   2018-11-07\n",
       "1     2018-11-07  1992-02-01    10904   2018-11-07\n",
       "2     2018-11-07  1992-03-01    10986   2018-11-07\n",
       "3     2018-11-07  1992-04-01    10738   2018-11-07\n",
       "4     2018-11-07  1992-05-01    10777   2018-11-07"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Gasoline\n",
    "gasoline = 'Resources/etl8_gasoline_stations.csv'\n",
    "gasoline_df = pd.read_csv(building_materials)\n",
    "gasoline_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>realtime_start</th>\n",
       "      <th>obs_date</th>\n",
       "      <th>revenue</th>\n",
       "      <th>realtime_end</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-01-01</td>\n",
       "      <td>27835</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-02-01</td>\n",
       "      <td>27720</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-03-01</td>\n",
       "      <td>27848</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-04-01</td>\n",
       "      <td>27867</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-05-01</td>\n",
       "      <td>27987</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  realtime_start    obs_date  revenue realtime_end\n",
       "0     2018-11-07  1992-01-01    27835   2018-11-07\n",
       "1     2018-11-07  1992-02-01    27720   2018-11-07\n",
       "2     2018-11-07  1992-03-01    27848   2018-11-07\n",
       "3     2018-11-07  1992-04-01    27867   2018-11-07\n",
       "4     2018-11-07  1992-05-01    27987   2018-11-07"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Grocery\n",
    "grocery = 'Resources/etl9_grocery_stores.csv'\n",
    "grocery_df = pd.read_csv(grocery)\n",
    "grocery_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>realtime_start</th>\n",
       "      <th>obs_date</th>\n",
       "      <th>revenue</th>\n",
       "      <th>realtime_end</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-01-01</td>\n",
       "      <td>7421</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-02-01</td>\n",
       "      <td>7425</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-03-01</td>\n",
       "      <td>7443</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-04-01</td>\n",
       "      <td>7516</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-05-01</td>\n",
       "      <td>7458</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  realtime_start    obs_date  revenue realtime_end\n",
       "0     2018-11-07  1992-01-01     7421   2018-11-07\n",
       "1     2018-11-07  1992-02-01     7425   2018-11-07\n",
       "2     2018-11-07  1992-03-01     7443   2018-11-07\n",
       "3     2018-11-07  1992-04-01     7516   2018-11-07\n",
       "4     2018-11-07  1992-05-01     7458   2018-11-07"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Healthcare\n",
    "health_care = 'Resources/etl10_health_personal_care_stores.csv'\n",
    "health_care_df = pd.read_csv(health_care)\n",
    "health_care_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>realtime_start</th>\n",
       "      <th>obs_date</th>\n",
       "      <th>revenue</th>\n",
       "      <th>realtime_end</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-01-01</td>\n",
       "      <td>33478</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-02-01</td>\n",
       "      <td>33817</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-03-01</td>\n",
       "      <td>33336</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-04-01</td>\n",
       "      <td>33776</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-05-01</td>\n",
       "      <td>34357</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  realtime_start    obs_date  revenue realtime_end\n",
       "0     2018-11-07  1992-01-01    33478   2018-11-07\n",
       "1     2018-11-07  1992-02-01    33817   2018-11-07\n",
       "2     2018-11-07  1992-03-01    33336   2018-11-07\n",
       "3     2018-11-07  1992-04-01    33776   2018-11-07\n",
       "4     2018-11-07  1992-05-01    34357   2018-11-07"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Vehicule parts\n",
    "vehicle_parts = 'Resources/etl11_motor_vehicle_parts_dealers.csv'\n",
    "vehicle_parts_df = pd.read_csv(vehicle_parts)\n",
    "vehicle_parts_df.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>realtime_start</th>\n",
       "      <th>obs_date</th>\n",
       "      <th>revenue</th>\n",
       "      <th>realtime_end</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-01-01</td>\n",
       "      <td>6515</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-02-01</td>\n",
       "      <td>6110</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-03-01</td>\n",
       "      <td>6018</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-04-01</td>\n",
       "      <td>6327</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2018-11-07</td>\n",
       "      <td>1992-05-01</td>\n",
       "      <td>6550</td>\n",
       "      <td>2018-11-07</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  realtime_start    obs_date  revenue realtime_end\n",
       "0     2018-11-07  1992-01-01     6515   2018-11-07\n",
       "1     2018-11-07  1992-02-01     6110   2018-11-07\n",
       "2     2018-11-07  1992-03-01     6018   2018-11-07\n",
       "3     2018-11-07  1992-04-01     6327   2018-11-07\n",
       "4     2018-11-07  1992-05-01     6550   2018-11-07"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Non stores\n",
    "nonstore = 'Resources/etl12_nonstore_retailers.csv'\n",
    "nonstore_df = pd.read_csv(nonstore)\n",
    "nonstore_df.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2- Transforming the data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Creating a filtered dataframe from specific columns: Observation Date and Revenue\n",
    "building_materials_df = building_materials_df[['obs_date','revenue']]\n",
    "clothing_store_df = clothing_store_df[['obs_date','revenue']]\n",
    "sales_department_df = sales_department_df[['obs_date','revenue']]\n",
    "sales_electronics_df = sales_electronics_df[['obs_date','revenue']]\n",
    "sales_food_bev_df = sales_food_bev_df[['obs_date','revenue']]\n",
    "sales_food_ser_df = sales_food_ser_df[['obs_date','revenue']]\n",
    "furniture_home_df = furniture_home_df[['obs_date','revenue']]\n",
    "gasoline_df = gasoline_df[['obs_date','revenue']]\n",
    "grocery_df = grocery_df[['obs_date','revenue']]\n",
    "health_care_df = health_care_df[['obs_date','revenue']]\n",
    "vehicle_parts_df = vehicle_parts_df[['obs_date','revenue']]\n",
    "nonstore_df = nonstore_df[['obs_date','revenue']]\n",
    "\n",
    "# building_materials_df.head()\n",
    "# clothing_store_df.head()\n",
    "# sales_department_df.head()\n",
    "# sales_electronics_df.head()\n",
    "# sales_food_bev_df.head()\n",
    "# sales_food_ser_df.head()\n",
    "# furniture_home_df.head()\n",
    "# gasoline_df.head()\n",
    "# grocery_df.head()\n",
    "# health_care_df.head()\n",
    "# vehicle_parts_df.head()\n",
    "# nonstore_df.head()\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 3- Loading our data into MySQL Workbench"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Creating database connection\n",
    "connection_string = \"root:Password@localhost:3306/census_revenue_db\"\n",
    "engine = create_engine(f'mysql://{connection_string}')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['building_materials_df',\n",
       " 'clothing_store_df',\n",
       " 'furniture_home_df',\n",
       " 'gasoline_df',\n",
       " 'grocery_df',\n",
       " 'health_care_df',\n",
       " 'nonstore_df',\n",
       " 'sales_department_df',\n",
       " 'sales_electronics_df',\n",
       " 'sales_food_bev_df',\n",
       " 'sales_food_ser_df',\n",
       " 'vehicle_parts_df']"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Confirming tables\n",
    "engine.table_names()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Loading DataFrames into database\n",
    "building_materials_df.to_sql(name='buildings', con=engine, if_exists='append', index=True)\n",
    "clothing_store_df.to_sql(name='clothing_stores', con=engine, if_exists='append', index=True)\n",
    "sales_department_df.to_sql(name='sales_departments', con=engine, if_exists='append', index=True)\n",
    "sales_electronics_df.to_sql(name='electronics', con=engine, if_exists='append', index=True)\n",
    "sales_food_bev_df.to_sql(name='food_baverage', con=engine, if_exists='append', index=True)\n",
    "sales_food_ser_df.to_sql(name='food_service', con=engine, if_exists='append', index=True)\n",
    "furniture_home_df.to_sql(name='home_furniture', con=engine, if_exists='append', index=True)\n",
    "gasoline_df.to_sql(name='gasoline', con=engine, if_exists='append', index=True)\n",
    "grocery_df.to_sql(name='grocery', con=engine, if_exists='append', index=True)\n",
    "health_care_df.to_sql(name='health_care', con=engine, if_exists='append', index=True)\n",
    "vehicle_parts_df.to_sql(name='vehicule_parts', con=engine, if_exists='append', index=True)\n",
    "nonstore_df.to_sql(name='non_store', con=engine, if_exists='append', index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>obs_date</th>\n",
       "      <th>revenue</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>1992-01-01</td>\n",
       "      <td>10845</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>1992-02-01</td>\n",
       "      <td>10904</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>1992-03-01</td>\n",
       "      <td>10986</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>1992-04-01</td>\n",
       "      <td>10738</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>1992-05-01</td>\n",
       "      <td>10777</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   index    obs_date  revenue\n",
       "0      0  1992-01-01    10845\n",
       "1      1  1992-02-01    10904\n",
       "2      2  1992-03-01    10986\n",
       "3      3  1992-04-01    10738\n",
       "4      4  1992-05-01    10777"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#By selecting the name of the data you will read the data from the sql table \n",
    "pd.read_sql_query('select * from buildings', con=engine).head()\n",
    "pd.read_sql_query('select * from (**choice_of_table**', con=engine).head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "PyData",
   "language": "python",
   "name": "pydata"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
